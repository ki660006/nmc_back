Imports System.Windows.Forms
Imports System.IO
Imports System.Xml
Imports System.Data.OracleClient

Imports DBORA.DbProvider
Imports COMMON.CommFN
Imports COMMON.CommLogin.LOGIN
Imports COMMON.SVar

Public Class CGWEB_J

    Public Function ExecuteDo_TaKe(ByVal rsBcNo As String, ByVal rsPassId As String, ByVal rsUseBfWknoYN As String) As String
        Dim sFn As String = "Public Function ExecuteDo_TaKe(String, String) As string"

        Try
            COMMON.CommFN.MdiMain.DB_Active_YN = "Y"

            Dim sURL = ""
            Dim wbReq As Net.WebRequest
            Dim wbRep As Net.WebResponse

            sURL += "http://" + PRG_CONST.SERVERIP + "/webapps/com/commonweb/xrw/.live?submit_id=TRLII00101&business_id=lis"
            sURL += "&instcd=" + PRG_CONST.SITECD + "&bcno=" + rsBcNo + "&passid=" + rsPassId + "&usrid=" + USER_INFO.USRID + "&usrip=" + USER_INFO.LOCALIP + "&"

            wbReq = Net.WebRequest.Create(sURL)
            wbRep = wbReq.GetResponse()

            Dim sr As System.IO.StreamReader = New System.IO.StreamReader(wbRep.GetResponseStream(), System.Text.Encoding.UTF8)
            Dim sRetVal = fnGet_XmlParsing(sr)

            Dim sWorkNo As String = ""

            Return sWorkNo

        Catch ex As Exception
            Throw (New Exception(ex.Message + " @" + sFn, ex))
        Finally
            COMMON.CommFN.MdiMain.DB_Active_YN = ""
        End Try
    End Function

    Public Function ExecuteDo_Cancel(ByVal r_stu As STU_CANCELWEB) As String
        Dim sFn As String = "Public Function ExecuteDo_Cancel(STU_CANCELWEB) As string"

        Try
            COMMON.CommFN.MdiMain.DB_Active_YN = "Y"

            Dim sURL = ""
            Dim wbReq As Net.WebRequest
            Dim wbRep As Net.WebResponse

            sURL += PRG_CONST.SERVERIP + "/webapps/com/commonweb/xrw/.live?submit_id=TRLII00101&business_id=lis"
            sURL += "&instcd=" + PRG_CONST.SITECD + "&jobgbn=" + r_stu.JOBGBN + "&cmtcd=" + r_stu.CMTCD + "&cmtcont=" + r_stu.CMTCONT
            sURL += "&regno=" + r_stu.REGNO + "&owngbn=" + r_stu.OWNGBN + "&bcnos=" + r_stu.BCNOS + "&testcds=" + r_stu.TESTCDS + "&spccds=" + r_stu.SPCCDS + "&fkocss=" + r_stu.FKOCSS
            sURL += "&usrid=" + USER_INFO.USRID + "&usrip=" + USER_INFO.LOCALIP + "&"

            wbReq = Net.WebRequest.Create(sURL)
            wbRep = wbReq.GetResponse()

            Dim sr As System.IO.StreamReader = New System.IO.StreamReader(wbRep.GetResponseStream(), System.Text.Encoding.UTF8)
            Dim sRetVal = fnGet_XmlParsing(sr)

            Dim sWorkNo As String = ""

            Return sWorkNo

        Catch ex As Exception
            Throw (New Exception(ex.Message + " @" + sFn, ex))
        Finally
            COMMON.CommFN.MdiMain.DB_Active_YN = ""
        End Try
    End Function

    Private Function fnGet_XmlParsing(ByVal r_sr As System.IO.StreamReader) As String

        Dim sFn As String = "fnGet_XmlParsing"

        Dim xmlReader As XmlTextReader = New Xml.XmlTextReader(r_sr)
        Dim sValue As String = ""

        Try
            While xmlReader.Read()
                Select Case xmlReader.NodeType
                    Case XmlNodeType.Comment
                    Case XmlNodeType.Element
                        If xmlReader.Name.ToLower = "data" Then
                            If sValue <> "" Then
                                sValue += Chr(4)
                            End If
                        End If
                    Case XmlNodeType.EndEntity
                    Case XmlNodeType.Text
                        sValue += xmlReader.Value.Trim + Chr(3)
                    Case XmlNodeType.CDATA
                        sValue += xmlReader.Value.Trim + Chr(3)
                    Case Else
                End Select
            End While

        Catch ex As XmlException
            Throw (New Exception(ex.Message, ex))

        Finally
            xmlReader.Close()
        End Try

        Return sValue

    End Function


End Class


Public Class CGWEB_B

End Class
